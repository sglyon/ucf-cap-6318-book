{"version":2,"kind":"Notebook","sha256":"2ad7998f602e5206665a8d656b467ac435812dca90f028139147e7009da1e376","slug":"rl-03-qlearning","location":"/reinforcement_learning/rl.03_qlearning.ipynb","dependencies":[],"frontmatter":{"title":"Reinforcement Learning – Q-Learning","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"cap-6318","language":"python"},"authors":[{"nameParsed":{"literal":"Spencer Lyon","given":"Spencer","family":"Lyon"},"name":"Spencer Lyon","orcid":"0009-0001-6461-885X","email":"spencer.lyon@ucf.edu","affiliations":["University of Central Florida","Valorum Data"],"id":"contributors-myst-generated-uid-0","corresponding":true}],"affiliations":[{"id":"University of Central Florida","name":"University of Central Florida"},{"id":"Valorum Data","name":"Valorum Data"}],"numbering":{"title":{"offset":1}},"thumbnail":"/build/sarsa_barto_sutton-ec1c9e86a95e8a4058308de2a8e1fc69.png","thumbnailOptimized":"/build/sarsa_barto_sutton-ec1c9e86a95e8a4058308de2a8e1fc69.webp","exports":[{"format":"ipynb","filename":"rl.03_qlearning.ipynb","url":"/build/rl.03_qlearning-9407d78fa305b9c65b4d54d32ec755ce.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"odwPkr0j1i"}],"key":"PwJveDqHk0"}],"key":"ufrZAwJdl4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Linear Algebra","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"iYojmPID4C"}],"key":"NqYRrY8PBj"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Statistics and Probability","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"cXK9HH8M1x"}],"key":"Ubmyqt5d1X"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Dynamic Programming","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"naLNgKGEfs"}],"key":"SyZvWcoV07"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Reinforcement Learning Introduction","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"r9lMuIfpNI"}],"key":"AUOdeclzFB"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Reinforcement Learning Sarsa algorithm","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"crodTLWdYE"}],"key":"YMI5gCvkoh"}],"key":"nqJL7GW6U4"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Outcomes","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"QfWHsC5FnJ"}],"key":"AQX4bujW6k"}],"key":"R6BIM25kRV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Know the difference between on policy and off policy learning","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"WP4rF0EvvZ"}],"key":"hKqRGF1JOB"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Learn the Q-learning algorithm for off policy TD based control","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"zlJvAYqp3d"}],"key":"Lyw7nEV06P"}],"key":"rn3HjgyvGF"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"References","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"MCZorDe7uk"}],"key":"yhpU8SBFMh"}],"key":"oO0P89zI8H"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Barto & Sutton book (online by authors ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"T9eqCOLqiU"},{"type":"link","url":"http://incompleteideas.net/book/the-book.html","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"W8Hc6wBz2q"}],"urlSource":"http://incompleteideas.net/book/the-book.html","key":"naTKpEaxM0"},{"type":"text","value":") chapters 4-6","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"QDixKCgL4Q"}],"key":"j20WdbRkP7"}],"key":"MGPa5BrKg5"}],"visibility":"show","key":"CWAgAUwfFa"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Recap","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KWvOejTN2B"}],"identifier":"recap","label":"Recap","html_id":"recap","implicit":true,"key":"OaEdfrtbnL"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In the RL problem agent observes ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bIqo27RmqS"},{"type":"inlineMath","value":"S","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>","key":"RWFiv4Avgg"},{"type":"text","value":", makes decision ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DfZIWJKJsQ"},{"type":"inlineMath","value":"A","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"bwwGHSHAA1"},{"type":"text","value":", sees reward and next state ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KBbSAyMJsQ"},{"type":"inlineMath","value":"R","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span>","key":"Qe9NL6nzWU"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LJyAohuNGp"},{"type":"inlineMath","value":"S'","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">S&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"kp58g7bxos"},{"type":"text","value":" -- then process repeats ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"V6iejprRTB"},{"type":"inlineMath","value":"S, A, R, S', A', ...","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>R</mi><mo separator=\"true\">,</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo separator=\"true\">,</mo><msup><mi>A</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">S, A, R, S&#x27;, A&#x27;, ...</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span></span></span></span>","key":"RWZsIbkSoa"}],"key":"mP05tUNwxW"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Sarsa uses a ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"UjSV2eKwsf"},{"type":"inlineMath","value":"(S, A, R, S', A')","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>S</mi><mo separator=\"true\">,</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>R</mi><mo separator=\"true\">,</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo separator=\"true\">,</mo><msup><mi>A</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(S, A, R, S&#x27;, A&#x27;)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"PloDrqsdlo"},{"type":"text","value":" quintuple to learn ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"DLNaUnVcAd"},{"type":"inlineMath","value":"Q(s, a)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Q(s, a)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span>","key":"KEuMzXR1Q4"},{"type":"text","value":" that approximates ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"cr1fMVkrBF"},{"type":"inlineMath","value":"q^*(s, a)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>q</mi><mo>∗</mo></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">q^*(s, a)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span>","key":"MmjptLZBAb"}],"key":"gDJFbMrgLE"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Notice Sarsa uses ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"nbw9kRVLrT"},{"type":"inlineMath","value":"\\epsilon","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span></span>","key":"BAALdee6xw"},{"type":"text","value":"-greedy policy to propose ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"EJ4SAZB5uM"},{"type":"inlineMath","value":"a'","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">a&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"mmuQobkFV8"},{"type":"text","value":" ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"S2204TXW7c"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"AND","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HVro8ppJW6"}],"key":"yExw6L2YUS"},{"type":"text","value":" uses that ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CyA6yEkEEL"},{"type":"inlineMath","value":"A'","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>A</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">A&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"M0ElPpjhyj"},{"type":"text","value":" when updating ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"EG10Uu4dYP"},{"type":"inlineMath","value":"Q","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"FQ96JaOy3b"},{"type":"text","value":"\n","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QEopoYwhTy"},{"type":"image","url":"/build/sarsa_barto_sutton-ec1c9e86a95e8a4058308de2a8e1fc69.png","alt":"sarsa_barto_sutton.png","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xF7Qe8zstZ","urlSource":"./sarsa_barto_sutton.png","urlOptimized":"/build/sarsa_barto_sutton-ec1c9e86a95e8a4058308de2a8e1fc69.webp"}],"key":"FmMDzVc98v"}],"key":"PgPBlpkd4Q"}],"visibility":"show","key":"dVjQHzvz27"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"On-policy vs off-policy methods","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rZVgglDik6"}],"identifier":"on-policy-vs-off-policy-methods","label":"On-policy vs off-policy methods","html_id":"on-policy-vs-off-policy-methods","implicit":true,"key":"NRxE5bCiyV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Because Sarsa uses the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YUURHn5Was"},{"type":"inlineMath","value":"Q","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"xEXpn9tRvD"},{"type":"text","value":" about which it is learning to generate ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ESol4DF2SS"},{"type":"inlineMath","value":"A'","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>A</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">A&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"BJqvzwvHga"},{"type":"text","value":", it is known as an ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JoloIKwRI1"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"on-policy","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qMnflxdNd5"}],"key":"mVOcnMxS7o"},{"type":"text","value":" learning method","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CtnN3JNK5Y"}],"key":"NhybLHNh2V"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"On policy: make decisions based on value (policy) function being learned","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"xsan5IzOa4"}],"key":"BWBUpYWNtk"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Alternative: follow any policy for proposing ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Z0cgp4Ss1m"},{"type":"inlineMath","value":"A'","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>A</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">A&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"yLYwjBl3Vf"},{"type":"text","value":", but use the greedy policy derived from ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"icomsoNZG1"},{"type":"inlineMath","value":"Q","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"JDt6EEK1oi"},{"type":"text","value":" when computing ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"X6j7k6U8rM"},{"type":"inlineMath","value":"TD(0)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mi>D</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">TD(0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span>","key":"Wk7A0AMV9Q"},{"type":"text","value":"...","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RngTlEPlBs"}],"key":"u3XDlZvfgc"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This is what we’ll explore today","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"WDigJQJ4h2"}],"key":"eQcEpWvfWw"}],"key":"Vhg5SqmADb"}],"visibility":"show","key":"W2yDolW0vY"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Q-learning","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RlXmM3J9bA"}],"identifier":"q-learning","label":"Q-learning","html_id":"q-learning","implicit":true,"key":"bYOBznHxpU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"An early theoretical breakthrough in RL was the idea of off-policy learning","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UmjTxUXUJx"}],"key":"oQRsPw9nbh"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The Q-learning algorithm was the first off-policy control algorithm to be suggested","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"LJ6l9YCgBk"}],"key":"d6WXehiyzY"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"It allows the algorithm to make use of ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RehOyfsPRS"},{"type":"inlineMath","value":"S, A, R, S'","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>R</mi><mo separator=\"true\">,</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">S, A, R, S&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"fA1gXJLwHT"},{"type":"text","value":" transitions obtained from ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"OrQhL37pmC"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"any","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hHxPusaQ7w"}],"key":"zoJmhhk8rS"},{"type":"text","value":" source, and still learn an approximation ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FCqkDfJHOL"},{"type":"inlineMath","value":"Q","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"Ahzy2ooFTg"},{"type":"text","value":" that converges to ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Z5kpSN89uv"},{"type":"inlineMath","value":"q^*","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>q</mi><mo>∗</mo></msup></mrow><annotation encoding=\"application/x-tex\">q^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8831em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span></span></span></span>","key":"RIrDXfzXZc"},{"type":"text","value":" with probability 1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"l0ACL5wyp5"}],"key":"qwbUbnqm7l"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Convergence requires some conditions, most importantly that the transitions ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Tf9IH7AcWn"},{"type":"inlineMath","value":"S, A, R, S'","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>R</mi><mo separator=\"true\">,</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">S, A, R, S&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"htPXenRoS9"},{"type":"text","value":" ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"WfBFr0i8oW"},{"type":"emphasis","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"cover","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"KzufkThJEI"}],"key":"J1ibOgUXE8"},{"type":"text","value":" the action space of ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"djKroZJ3VP"},{"type":"inlineMath","value":"q^*","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>q</mi><mo>∗</mo></msup></mrow><annotation encoding=\"application/x-tex\">q^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8831em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span></span></span></span>","key":"GwWiViwhgu"}],"key":"lIJnFZ1pSU"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Coverage","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ogT3hFElHF"}],"key":"JitPUAz7Wa"},{"type":"text","value":" means all (s, a) pairs that are optimal under ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CScERpoEKe"},{"type":"inlineMath","value":"q^*","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>q</mi><mo>∗</mo></msup></mrow><annotation encoding=\"application/x-tex\">q^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8831em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span></span></span></span>","key":"C0ETuCC4sM"},{"type":"text","value":" must be visited by the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"hKoelZ8MYz"},{"type":"inlineMath","value":"S, A, R, S'","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>R</mi><mo separator=\"true\">,</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">S, A, R, S&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"AB4kHnSKQf"},{"type":"text","value":" transitions","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"biJdHaQIhA"}],"key":"BW3IWd80VF"}],"key":"zmh6T3AUKj"}],"visibility":"show","key":"xAtb1DzMWb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example: Self-Driving Car","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lF6mA3Z9lT"}],"identifier":"example-self-driving-car","label":"Example: Self-Driving Car","html_id":"example-self-driving-car","implicit":true,"key":"r4E8a8oTpV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Goal: train RL agent to safely drive vechicle","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oaD6MURd0Q"}],"key":"SvLlDN6nET"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Sarsa method:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"W1FIe1pgEf"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Give control of vehicle over to Sarsa, so it can choose ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"P3vA0QZXx4"},{"type":"inlineMath","value":"A","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"F5uDmhqgN3"},{"type":"text","value":" and observe implied ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LZVGVBNzVG"},{"type":"inlineMath","value":"R","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span>","key":"Go6Q0wzOmN"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"j41DA6vN3s"},{"type":"inlineMath","value":"S'","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">S&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"rVidy40eNX"},{"type":"text","value":" transitions","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VcwRCy3lcj"}],"key":"qgFDHwX66O"}],"key":"zhs0KtaQWK"}],"key":"Th8BlAL8DV"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Off-policy:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"u6fvZT3Qgz"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Let human expert driver drive vehicle in intended way","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"aHjqkZBfW5"}],"key":"Du0BEAcbVt"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Record ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"OUo4EPnsXG"},{"type":"inlineMath","value":"S, A, R, S'","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>R</mi><mo separator=\"true\">,</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">S, A, R, S&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"cgaHtmGHHs"},{"type":"text","value":" transitions visited by human driver","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"BTwjcmIAiB"}],"key":"iJx9ayAPpz"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Train RL agent based on data generated from human experience","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"d4YDgREya5"}],"key":"MHMWzcLvUG"}],"key":"XXREl8t4SO"}],"key":"U41GBQNota"}],"key":"Ye7gWg4wW6"}],"key":"oJnWGZdDjR"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Q-learning Algorithm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K0MNs1wpVS"}],"identifier":"the-q-learning-algorithm","label":"The Q-learning Algorithm","html_id":"the-q-learning-algorithm","implicit":true,"key":"gamATvxevk"},{"type":"image","url":"/build/q-learning_barto_sut-ad76f2782eb52a7f3c7032a9fca5c4c8.png","alt":"q-learning_barto_sutton.png","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wXvpN2KSWd","urlSource":"./q-learning_barto_sutton.png","urlOptimized":"/build/q-learning_barto_sut-ad76f2782eb52a7f3c7032a9fca5c4c8.webp"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineMath","value":"A","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"gu9ZSCzqE9"},{"type":"text","value":" that are suggested are ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wCvCqamP7p"},{"type":"inlineMath","value":"\\epsilon","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span></span>","key":"WParHp0jgY"},{"type":"text","value":"-greedy in ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MXC2MJ9zEp"},{"type":"inlineMath","value":"Q","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"OVhFMP5taJ"}],"key":"DGL3Snev1M"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This is a ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ri8mmVo7gS"},{"type":"emphasis","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"suggestion","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"aTgrSAt85X"}],"key":"xGufqF8B66"},{"type":"text","value":" for how to generate ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"AalzfnxbjE"},{"type":"inlineMath","value":"A","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"dqGnXJlEsN"},{"type":"text","value":", but anything else (including totally random) could be used","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"cYh5K5gu0d"}],"key":"eYVnNpOA5C"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"When updating the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"f3RjAZpOfF"},{"type":"inlineMath","value":"t+1","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">t+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6984em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"Nzz2O7V1tB"},{"type":"text","value":" component of ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rdTU1DhxlU"},{"type":"inlineMath","value":"TD(0)(Q)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mi>D</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>Q</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">TD(0)(Q)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mclose\">)</span></span></span></span>","key":"i9TmB9Amwn"},{"type":"text","value":" there is an explicit ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"uLoPTcY3cC"},{"type":"inlineMath","value":"max_{a'} Q(S', a')","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>a</mi><msub><mi>x</mi><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></msub><mi>Q</mi><mo stretchy=\"false\">(</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo separator=\"true\">,</mo><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">max_{a&#x27;} Q(S&#x27;, a&#x27;)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ma</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.328em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6828em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">Q</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"wBkolb6OKQ"},{"type":"text","value":" -- it is always ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"aKUVlR6sV7"},{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"greedy","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"BFAm0DakkG"}],"key":"rA98Bxu6WE"}],"key":"QssUUx1BdK"}],"key":"jMbVKdYFIE"},{"type":"comment","value":" - By computing $TD(0)(Q)$ updates that are greedy in $Q$, Q-learning can converge to $q^*$ regardless of how $A$ are generated ","key":"IpRPDw8PXV"}],"visibility":"show","key":"qdB5qmfTaT"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Q-learning Farkle","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"slLrwe6tJ7"}],"identifier":"q-learning-farkle","label":"Q-learning Farkle","html_id":"q-learning-farkle","implicit":true,"key":"BbHrAiifq6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s implement the Q-learning algorithm to solve our farkle game","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BrnC1ylBTI"}],"key":"BFjpToIIsS"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"First, some code optimizations:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"b6J1wfQI0M"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"inlineCode","value":"farkle.py","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oQekwJdwUw"},{"type":"text","value":" has been updated to include a method ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WZ4wY7XMmP"},{"type":"inlineCode","value":"State.observable_state","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"idDzs1mlkW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This method returns a tuple containing only how many dice are rollable, sum collected in turn, and what rolled dice are showing","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"YBkKqLurDh"}],"key":"JMZwO3SV2P"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Drops scores, round, etc.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"spWdXA9mqp"}],"key":"IwxxuEeX0m"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Implication -- we will have agent learn to maximize score each turn","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"nazxhPe1oP"}],"key":"sp4xyJ5AUH"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"If agent scores high every turn, should be able to win game","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"y2fr30j7Xu"}],"key":"LigI8LXhrb"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Loses ability to customize behavior based on “stage” of game (aggressive play to catch up, or conservative to maintain lead)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"BV34MHxn20"}],"key":"Tpr3R3Wk4B"}],"key":"sMQBWunGEX"}],"key":"g3SQym5aDU"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Creatd a ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"apZPBORCLW"},{"type":"inlineCode","value":"TablularQ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"cV6mwOsOa3"},{"type":"text","value":" class below that uses this ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"raUrXT7wE2"},{"type":"inlineCode","value":"State.observable_state","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"C41LgXbyJS"},{"type":"text","value":" method","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"llQqurhQ7C"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Allows RL algorithms to not worry about ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"IIOUtWRTed"},{"type":"inlineCode","value":"State.observable_state","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"FgNGuBYoZQ"}],"key":"OzqSvXsZfM"}],"key":"QGaZyetNfO"}],"key":"LKHf1tV1rE"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Remove history tracking from ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"wlHosfvGpM"},{"type":"inlineCode","value":"FarkleEnv","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"dM12FABGG9"},{"type":"text","value":" (see ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"LAS4bmDsDA"},{"type":"inlineCode","value":"FarkleEnv","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"GNPjGatlzq"},{"type":"text","value":" in farkle.py file)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"xBK0rPZT5s"}],"key":"exisfMk73h"}],"key":"FWyxjTJQXC"}],"key":"bvjb9u1GPt"}],"key":"s6jANh4n9k"}],"visibility":"show","key":"jQ4WuZhsum"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from collections import defaultdict\nimport random\n\nimport numpy as np\nimport matplotlib.pyplot as plt","visibility":"show","key":"G9pBaENqRC"},{"type":"output","id":"g1XNxl79PnNQjPdloGDIo","data":[],"visibility":"show","key":"u9TzeUAofx"}],"visibility":"show","key":"Tl3w5EAChd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"HXZP7lBiIO"},{"type":"output","id":"pUhtU0Vl3egFDJoeweMTB","data":[],"key":"n7XF7HC5AL"}],"key":"no0pV9xSwE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class TabularQ:\n    def __init__(self, default_value= lambda: 0):\n        val = default_value if callable(default_value) else lambda x: default_value\n        self.Q = defaultdict(lambda: default_value)\n\n    def __call__(self, s, a):\n        return self.Q[(s.observable_state(), a)]\n\n    def __setitem__(self, k, v):\n        s, a = k\n        self.Q[(s.observable_state(), a)] = v\n\n    def get_greedy(self, s, A_s):\n        vals = [self(s, a) for a in A_s]\n        max_val = max(vals)\n        return random.choice([a for (a, v) in zip(A_s, vals) if v == max_val])","key":"XFxKLPLOGB"},{"type":"output","id":"nUkjPmwnA6M74AEH7KAh8","data":[],"key":"hi6pJG8gO7"}],"key":"llUS1YGzrh"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Q-learning implementation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"INeAl1kf1j"}],"identifier":"q-learning-implementation","label":"Q-learning implementation","html_id":"q-learning-implementation","implicit":true,"key":"aBeXWgYjTs"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We implement Q-learning in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aWUvEuPXOr"},{"type":"inlineCode","value":"QLearning","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JWWa2dPOup"},{"type":"text","value":" class below","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LKVkkBeusZ"}],"key":"GWYBoHhwBE"}],"key":"P3xj5T2g4p"}],"visibility":"show","key":"Iw4cOi9uGx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class Qlearning(object):\n    def __init__(self, environment, default_value=0, epsilon=0.9, alpha=0.1, beta=1.0):\n        self.env = environment\n        self.Q = TabularQ(default_value=default_value)\n        self.epsilon = epsilon\n        self.alpha = alpha\n        self.beta = beta\n\n        self.restart_episode()\n\n    def restart_episode(self):\n        self.s = self.env.reset()\n\n    def get_greedy(self, s, A_s):\n        return self.Q.get_greedy(s, A_s)\n\n    def generate_A(self, s, A_s):\n        if random.random() > self.epsilon:\n            return random.choice(A_s)\n        return self.get_greedy(s, A_s)\n\n    def done(self, s=None) -> bool:\n        return self.env.done(s if s else self.s)\n\n    def step(self):\n        s = self.s\n        # first generate an A\n        A_s = self.env.enumerate_options(s)\n        a = self.generate_A(s, A_s)\n\n        # take step\n        sp, r = self.env.step(s, a)\n\n        if self.done(sp):\n            # game is over\n            self.s = sp\n            return\n\n        # get greedy a' based on Q and sp\n        A_sp = self.env.enumerate_options(sp)\n        ap = self.get_greedy(sp, A_sp)\n\n        # Do TD update\n        Q, α, β = self.Q, self.alpha, self.beta  # simplify notation\n        Q[(s, a)] = Q(s, a) + α * (r + β * Q(sp, ap) - Q(s, a))\n\n        # step forward in time\n        self.s = sp","key":"DxAFerQoYm"},{"type":"output","id":"NT1-L3nGb-ZMhQvUoB7sD","data":[],"key":"npb7RYPcca"}],"key":"IRstY7WhXu"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Single Game test","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NWdN7mHoCB"}],"identifier":"single-game-test","label":"Single Game test","html_id":"single-game-test","implicit":true,"key":"ag1GJLTPlg"}],"visibility":"show","key":"b1T5hk3FYh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from farkle import FarkleEnv, play_game, play_many_games","key":"oTmjIBxwCT"},{"type":"output","id":"5oHjfuWAOIrp53L8MVb4j","data":[],"key":"s9fa5W8RxX"}],"key":"eWp4KYrvkO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"random.seed(40)\n\nenv = FarkleEnv(track_history=False)\nql = Qlearning(env)\nplay_game(ql)\nql.s","key":"FgPXw467R4"},{"type":"output","id":"_YugmyLUAqhpX4-sLp7BX","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"Round: 86. Score: [10050, 9300]","content_type":"text/plain"}}}],"key":"Tx0p2DbXUo"}],"key":"nM4etglDdv"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Longer training","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W8V6JPanrd"}],"identifier":"longer-training","label":"Longer training","html_id":"longer-training","implicit":true,"key":"GnW3iUKHDO"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s now let our qlearning algorithm train on 5,000 games","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"phBFpprkqI"}],"key":"b5PtJG4Igx"}],"key":"zmc9P9VFOn"}],"visibility":"show","key":"nueHpfsXmu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n\nrandom.seed(42)  # reset seed for reproducibility\nqlearning_history = play_many_games(ql, 5000)","key":"g2Foepkk08"},{"type":"output","id":"HwtMRagIk8DJjh4dLtLF0","data":[{"name":"stdout","output_type":"stream","text":"Done with 0/5000 (len(Q) = 539)\nDone with 500/5000 (len(Q) = 7309)\nDone with 1000/5000 (len(Q) = 8110)\nDone with 1500/5000 (len(Q) = 8658)\nDone with 2000/5000 (len(Q) = 9108)\nDone with 2500/5000 (len(Q) = 9433)\nDone with 3000/5000 (len(Q) = 9832)\nDone with 3500/5000 (len(Q) = 10164)\nDone with 4000/5000 (len(Q) = 10476)\nDone with 4500/5000 (len(Q) = 10779)\nCPU times: user 34.5 s, sys: 111 ms, total: 34.6 s\nWall time: 34.7 s\n"}],"key":"s5QTzDtjCM"}],"key":"DW1lmdiBnc"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"code","lang":"python","executable":true,"value":"def plot_win_rate(history):\n    won = np.array([s.scores[0] > s.scores[1] for s in history])\n    game_idx = np.arange(len(won))\n\n    fig, ax = plt.subplots(figsize=(10, 6))\n    ax.plot(game_idx, won.cumsum())\n    ax.plot(game_idx, 0.5 * game_idx)\n    plt.legend([\"algo\", \"E[random agent]\"])\n    print(f\"won {sum(won)}/{len(won)} games\")","key":"bBWjLkcEYF"},{"type":"output","id":"Z5-sGqizR-3CAlZqZwdxT","data":[],"key":"XdeHmUCXXC"}],"key":"z16xkK4MWI"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_win_rate(qlearning_history)","key":"NemElu7NWk"},{"type":"output","id":"B5rzPfxp_bZVOiEY1eFJi","data":[{"name":"stdout","output_type":"stream","text":"won 4103/5000 games\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"04c4c884f6066f91d98d1a14c6701900","path":"/build/04c4c884f6066f91d98d1a14c6701900.png"},"text/plain":{"content":"<Figure size 1000x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"ontzqCbZuD"}],"key":"ddknn8w19f"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Excellent! Our Q-learning algorithm seems to be doing quite a bit better than we would expect a random agent to do","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rBvrOHjwlb"}],"key":"OQrfIa2GVp"}],"key":"ZPvDpNqnCj"}],"key":"OlfFH8RaxZ"}],"key":"GZLmnTYgdW"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Reinforcement Learning – TD learning","url":"/rl-02-tdlearning","group":"Reinforcement Learning"},"next":{"title":"Reinforcement Learning -- Economic Example","url":"/rl-04-career-rl","group":"Reinforcement Learning"}}},"domain":"http://localhost:3000"}