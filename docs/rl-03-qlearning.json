{"version":2,"kind":"Notebook","sha256":"2ad7998f602e5206665a8d656b467ac435812dca90f028139147e7009da1e376","slug":"rl-03-qlearning","location":"/reinforcement_learning/rl.03_qlearning.ipynb","dependencies":[],"frontmatter":{"title":"Reinforcement Learning – Q-Learning","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"cap-6318","language":"python"},"authors":[{"nameParsed":{"literal":"Spencer Lyon","given":"Spencer","family":"Lyon"},"name":"Spencer Lyon","orcid":"0009-0001-6461-885X","email":"spencer.lyon@ucf.edu","affiliations":["University of Central Florida","Valorum Data"],"id":"contributors-myst-generated-uid-0","corresponding":true}],"affiliations":[{"id":"University of Central Florida","name":"University of Central Florida"},{"id":"Valorum Data","name":"Valorum Data"}],"numbering":{"title":{"offset":1}},"thumbnail":"/build/sarsa_barto_sutton-ec1c9e86a95e8a4058308de2a8e1fc69.png","thumbnailOptimized":"/build/sarsa_barto_sutton-ec1c9e86a95e8a4058308de2a8e1fc69.webp","exports":[{"format":"ipynb","filename":"rl.03_qlearning.ipynb","url":"/build/rl.03_qlearning-9407d78fa305b9c65b4d54d32ec755ce.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"beXEauaSuz"}],"key":"hY6IX4yVwX"}],"key":"zRVYEbQXkn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Linear Algebra","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RovZqqWA4v"}],"key":"J1XbZTSBRZ"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Statistics and Probability","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"QtOAynI2oE"}],"key":"jWCCDkZXUU"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Dynamic Programming","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ebaWftQPSE"}],"key":"IFsxBluuEy"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Reinforcement Learning Introduction","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"tvAGG2oCDv"}],"key":"uPdlYcV0Fm"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Reinforcement Learning Sarsa algorithm","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"COD13uFd9g"}],"key":"BhRzf78VUY"}],"key":"IXHK0tCavk"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Outcomes","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"n6pVoJQ5Py"}],"key":"VVo2lAGnpR"}],"key":"ooAy8IsQI2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Know the difference between on policy and off policy learning","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"C4fVrFYG05"}],"key":"WoL3Wo3DkV"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Learn the Q-learning algorithm for off policy TD based control","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"x96yUykzpC"}],"key":"ic7Coa97VP"}],"key":"HyafPyjZjE"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"References","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"xie33nl7qi"}],"key":"pG9Ay1gVB6"}],"key":"vIiMXKAfLB"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Barto & Sutton book (online by authors ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"TINCEBkgfk"},{"type":"link","url":"http://incompleteideas.net/book/the-book.html","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"fXJzGO0Iyq"}],"urlSource":"http://incompleteideas.net/book/the-book.html","key":"izFMXgU4Cu"},{"type":"text","value":") chapters 4-6","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"CixNj30KZ0"}],"key":"JoNxzTIRDm"}],"key":"vOXD5jc87U"}],"visibility":"show","key":"XYfsUM18js"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Recap","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"w1xE60E7uz"}],"identifier":"recap","label":"Recap","html_id":"recap","implicit":true,"key":"MscmUPuqEr"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In the RL problem agent observes ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VysQGIykHk"},{"type":"inlineMath","value":"S","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>","key":"wdiqULb0Kz"},{"type":"text","value":", makes decision ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GM14eIpqDZ"},{"type":"inlineMath","value":"A","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"F0t0Dj082P"},{"type":"text","value":", sees reward and next state ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oo2sngL9CD"},{"type":"inlineMath","value":"R","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span>","key":"nq0RXvChtt"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yLata1CWOK"},{"type":"inlineMath","value":"S'","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">S&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"NpiXAeQRDo"},{"type":"text","value":" -- then process repeats ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"L8S9audNVE"},{"type":"inlineMath","value":"S, A, R, S', A', ...","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>R</mi><mo separator=\"true\">,</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo separator=\"true\">,</mo><msup><mi>A</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">S, A, R, S&#x27;, A&#x27;, ...</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span></span></span></span>","key":"VHFjyOxqrW"}],"key":"ImRDbt3nIM"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Sarsa uses a ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"fyK8EMVzYU"},{"type":"inlineMath","value":"(S, A, R, S', A')","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>S</mi><mo separator=\"true\">,</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>R</mi><mo separator=\"true\">,</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo separator=\"true\">,</mo><msup><mi>A</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(S, A, R, S&#x27;, A&#x27;)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"kntzrBwrQm"},{"type":"text","value":" quintuple to learn ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"cpmqFtKSDV"},{"type":"inlineMath","value":"Q(s, a)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Q(s, a)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span>","key":"DYKaiGUscL"},{"type":"text","value":" that approximates ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"bWdxTvTfdW"},{"type":"inlineMath","value":"q^*(s, a)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>q</mi><mo>∗</mo></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">q^*(s, a)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span>","key":"Hmws2mB6WY"}],"key":"ssqVroRtlD"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Notice Sarsa uses ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"iMIXDpIvnJ"},{"type":"inlineMath","value":"\\epsilon","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span></span>","key":"EUglMkcVLq"},{"type":"text","value":"-greedy policy to propose ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HZvfqUR6BS"},{"type":"inlineMath","value":"a'","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">a&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"SrtUOOm4El"},{"type":"text","value":" ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KNf5L8lAkF"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"AND","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GqrzXxtAIS"}],"key":"d4PgFKQEMA"},{"type":"text","value":" uses that ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DtWiJEyqnK"},{"type":"inlineMath","value":"A'","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>A</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">A&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"ZxKHFlfLV4"},{"type":"text","value":" when updating ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FxqZpBF9xy"},{"type":"inlineMath","value":"Q","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"sw3im0hQq0"},{"type":"text","value":"\n","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ToCWPU5aMA"},{"type":"image","url":"/build/sarsa_barto_sutton-ec1c9e86a95e8a4058308de2a8e1fc69.png","alt":"sarsa_barto_sutton.png","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LuAH7lvopB","urlSource":"./sarsa_barto_sutton.png","urlOptimized":"/build/sarsa_barto_sutton-ec1c9e86a95e8a4058308de2a8e1fc69.webp"}],"key":"WKldn06HTd"}],"key":"CtsHL9gb7L"}],"visibility":"show","key":"i1laQKNuBF"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"On-policy vs off-policy methods","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FfsXppID9G"}],"identifier":"on-policy-vs-off-policy-methods","label":"On-policy vs off-policy methods","html_id":"on-policy-vs-off-policy-methods","implicit":true,"key":"fizTjOv5eU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Because Sarsa uses the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RIQzo1EVhi"},{"type":"inlineMath","value":"Q","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"ioaJLDfUwC"},{"type":"text","value":" about which it is learning to generate ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Xl1PzfS4oJ"},{"type":"inlineMath","value":"A'","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>A</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">A&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"hgUsXoNJlk"},{"type":"text","value":", it is known as an ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mnYYyhHdyQ"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"on-policy","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jBoA7zgONs"}],"key":"hYZbl0STMb"},{"type":"text","value":" learning method","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aoFk80Jixr"}],"key":"OF0yAVVnIv"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"On policy: make decisions based on value (policy) function being learned","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"FluhNOFAyc"}],"key":"eQOCRNaWEO"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Alternative: follow any policy for proposing ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CQWct4LlAA"},{"type":"inlineMath","value":"A'","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>A</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">A&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"yBtKNaXKQr"},{"type":"text","value":", but use the greedy policy derived from ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yQJGRs9Q3f"},{"type":"inlineMath","value":"Q","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"dT54B2AF1S"},{"type":"text","value":" when computing ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DGV4aa0Q6x"},{"type":"inlineMath","value":"TD(0)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mi>D</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">TD(0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span>","key":"isZMOzr220"},{"type":"text","value":"...","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GxdLInho2g"}],"key":"ULluuX2m9P"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This is what we’ll explore today","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jxCuZVDcoJ"}],"key":"cOCPogQ7Ip"}],"key":"GlPOiGEq0s"}],"visibility":"show","key":"EDMnbK47Yi"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Q-learning","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s6e7dWjVlo"}],"identifier":"q-learning","label":"Q-learning","html_id":"q-learning","implicit":true,"key":"kfJUS6HsCU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"An early theoretical breakthrough in RL was the idea of off-policy learning","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GRAfS6mouI"}],"key":"soJrq4vZLS"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The Q-learning algorithm was the first off-policy control algorithm to be suggested","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"e19Q7CiFEB"}],"key":"xG881MlKmQ"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"It allows the algorithm to make use of ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ze3YWlPvKX"},{"type":"inlineMath","value":"S, A, R, S'","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>R</mi><mo separator=\"true\">,</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">S, A, R, S&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"J4prZ71wVW"},{"type":"text","value":" transitions obtained from ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ROkgnZhVOp"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"any","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"c2V0FHhgcu"}],"key":"I2sAgujUpW"},{"type":"text","value":" source, and still learn an approximation ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uGrmOT6TWp"},{"type":"inlineMath","value":"Q","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"YdXe74ImFQ"},{"type":"text","value":" that converges to ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TokuGEqSx9"},{"type":"inlineMath","value":"q^*","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>q</mi><mo>∗</mo></msup></mrow><annotation encoding=\"application/x-tex\">q^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8831em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span></span></span></span>","key":"hZzu9rAi0X"},{"type":"text","value":" with probability 1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ncj5R7BslC"}],"key":"oyJvndM6br"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Convergence requires some conditions, most importantly that the transitions ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"FW37jQ8yr7"},{"type":"inlineMath","value":"S, A, R, S'","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>R</mi><mo separator=\"true\">,</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">S, A, R, S&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"Xmjml2oTyy"},{"type":"text","value":" ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"LWv4Ikr3HS"},{"type":"emphasis","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"cover","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"VhlI5PTYeO"}],"key":"JFBOEYml1b"},{"type":"text","value":" the action space of ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ZEmTPpcRGJ"},{"type":"inlineMath","value":"q^*","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>q</mi><mo>∗</mo></msup></mrow><annotation encoding=\"application/x-tex\">q^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8831em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span></span></span></span>","key":"ewvTnIrc6k"}],"key":"SDWb6QzmZu"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Coverage","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"T0h0uBFgmD"}],"key":"cwga3ihaBB"},{"type":"text","value":" means all (s, a) pairs that are optimal under ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Ff3Dd9YYOI"},{"type":"inlineMath","value":"q^*","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>q</mi><mo>∗</mo></msup></mrow><annotation encoding=\"application/x-tex\">q^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8831em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span></span></span></span>","key":"aR5KpyBZDm"},{"type":"text","value":" must be visited by the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"EeTTrsCMVx"},{"type":"inlineMath","value":"S, A, R, S'","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>R</mi><mo separator=\"true\">,</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">S, A, R, S&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"BuKMBwl6bc"},{"type":"text","value":" transitions","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"PQO28xcKvc"}],"key":"tbquQatnAo"}],"key":"fhzh1pSgMG"}],"visibility":"show","key":"s5KNgP29ff"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example: Self-Driving Car","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Oev9aMz7xG"}],"identifier":"example-self-driving-car","label":"Example: Self-Driving Car","html_id":"example-self-driving-car","implicit":true,"key":"CKwcMbXEPU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Goal: train RL agent to safely drive vechicle","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SR3szvL4VK"}],"key":"KzRT8xsOLB"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Sarsa method:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"mbfe8Z9Zxj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Give control of vehicle over to Sarsa, so it can choose ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XFnMO5ssVb"},{"type":"inlineMath","value":"A","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"SxsosNUS6p"},{"type":"text","value":" and observe implied ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VtGFBnKOuM"},{"type":"inlineMath","value":"R","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span>","key":"suu4vMvm4V"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RfY1vVDkFi"},{"type":"inlineMath","value":"S'","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">S&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"GpttzXLQ5q"},{"type":"text","value":" transitions","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"y81seuPVUy"}],"key":"KMYfvpWEJV"}],"key":"oINBfKGHoz"}],"key":"JNRuGgTBYy"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Off-policy:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"tYKu746Oa5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Let human expert driver drive vehicle in intended way","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"g8f5YaFEhc"}],"key":"amzkXNpGBb"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Record ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Stdyac5dVl"},{"type":"inlineMath","value":"S, A, R, S'","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>R</mi><mo separator=\"true\">,</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">S, A, R, S&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"eqUSHsREqO"},{"type":"text","value":" transitions visited by human driver","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"LWJjQU6BWF"}],"key":"NfRLKQNEcB"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Train RL agent based on data generated from human experience","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"mELkEddHeQ"}],"key":"ch5PnZTpMA"}],"key":"TiOAY9A4Yy"}],"key":"VgldZ9EYuT"}],"key":"wZ3cd6LRCJ"}],"key":"iSig8Hyiep"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Q-learning Algorithm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P0slIM6ZJH"}],"identifier":"the-q-learning-algorithm","label":"The Q-learning Algorithm","html_id":"the-q-learning-algorithm","implicit":true,"key":"buTDv3W0Pw"},{"type":"image","url":"/build/q-learning_barto_sut-ad76f2782eb52a7f3c7032a9fca5c4c8.png","alt":"q-learning_barto_sutton.png","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zHIayH9X0T","urlSource":"./q-learning_barto_sutton.png","urlOptimized":"/build/q-learning_barto_sut-ad76f2782eb52a7f3c7032a9fca5c4c8.webp"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineMath","value":"A","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"jikEt7QuQg"},{"type":"text","value":" that are suggested are ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Ow0BPFdV42"},{"type":"inlineMath","value":"\\epsilon","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span></span>","key":"IqztAlAvPd"},{"type":"text","value":"-greedy in ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Iu5AUtdbKS"},{"type":"inlineMath","value":"Q","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"wAiJdNL74T"}],"key":"ZcIpsngBbl"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This is a ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Pb9YccWNYz"},{"type":"emphasis","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"suggestion","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"xI2DaqCMCj"}],"key":"ZXpngRCrlt"},{"type":"text","value":" for how to generate ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"u0Sgh2TCfz"},{"type":"inlineMath","value":"A","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"S8urRVKdzo"},{"type":"text","value":", but anything else (including totally random) could be used","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"dzdXHfGrR5"}],"key":"E2XHcxLwwf"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"When updating the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"EbTcUtO8BR"},{"type":"inlineMath","value":"t+1","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">t+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6984em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"Om5FUglQMx"},{"type":"text","value":" component of ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"MGkrZYqwzW"},{"type":"inlineMath","value":"TD(0)(Q)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mi>D</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>Q</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">TD(0)(Q)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mclose\">)</span></span></span></span>","key":"YVMPAclCap"},{"type":"text","value":" there is an explicit ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CTlqUrU65g"},{"type":"inlineMath","value":"max_{a'} Q(S', a')","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>a</mi><msub><mi>x</mi><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></msub><mi>Q</mi><mo stretchy=\"false\">(</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo separator=\"true\">,</mo><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">max_{a&#x27;} Q(S&#x27;, a&#x27;)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ma</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.328em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6828em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">Q</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"MlXHuZ0BM9"},{"type":"text","value":" -- it is always ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"YwJ0EO1liT"},{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"greedy","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"X2MSJqxAc8"}],"key":"jmarFY8UYg"}],"key":"Mwx12Pk2dC"}],"key":"QwKGIczxLT"},{"type":"comment","value":" - By computing $TD(0)(Q)$ updates that are greedy in $Q$, Q-learning can converge to $q^*$ regardless of how $A$ are generated ","key":"SLZdkPcYzP"}],"visibility":"show","key":"xTPiMZZEJb"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Q-learning Farkle","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xxZftTDkfH"}],"identifier":"q-learning-farkle","label":"Q-learning Farkle","html_id":"q-learning-farkle","implicit":true,"key":"vAtPa6S1Wn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s implement the Q-learning algorithm to solve our farkle game","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ejtRcm3ZjQ"}],"key":"kribeQY6ho"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"First, some code optimizations:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Wy8l0l8Ox2"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"inlineCode","value":"farkle.py","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZuFnisPhs9"},{"type":"text","value":" has been updated to include a method ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SIQ2TpECUC"},{"type":"inlineCode","value":"State.observable_state","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"immHZCInU2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This method returns a tuple containing only how many dice are rollable, sum collected in turn, and what rolled dice are showing","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"QqyGiCOCYa"}],"key":"fcmb37NxYv"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Drops scores, round, etc.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IP8k6wUQNG"}],"key":"SVjHm1fdhv"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Implication -- we will have agent learn to maximize score each turn","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"jwQFKL4ivM"}],"key":"VeU8PxbIzp"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"If agent scores high every turn, should be able to win game","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"op347jA4ga"}],"key":"vadxTvTCQc"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Loses ability to customize behavior based on “stage” of game (aggressive play to catch up, or conservative to maintain lead)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"fcwHwK3zpv"}],"key":"MF31iw51tl"}],"key":"FPOO48EPt8"}],"key":"MywbmvZ9ni"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Creatd a ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"UPhcnTRCty"},{"type":"inlineCode","value":"TablularQ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"nEiNeEGesR"},{"type":"text","value":" class below that uses this ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"QLhwOsuVxu"},{"type":"inlineCode","value":"State.observable_state","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"hekR5oYTjN"},{"type":"text","value":" method","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"MmdSPlJh2J"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Allows RL algorithms to not worry about ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Uny3xMhBvB"},{"type":"inlineCode","value":"State.observable_state","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"LXtqeCoe6R"}],"key":"WR17uPwrfO"}],"key":"kk4AjHE5GG"}],"key":"eaEDn3F13B"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Remove history tracking from ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Pa8gDk8aDb"},{"type":"inlineCode","value":"FarkleEnv","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"FVrvWHrQju"},{"type":"text","value":" (see ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"JSFiQThXZf"},{"type":"inlineCode","value":"FarkleEnv","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"fhElBAFtCU"},{"type":"text","value":" in farkle.py file)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"hNWitkRWYi"}],"key":"PArpqOKtNj"}],"key":"rSPCCnSdhx"}],"key":"sXSdUgqOOC"}],"key":"c1NTfUzFvh"}],"visibility":"show","key":"KkSb1ZLBB5"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from collections import defaultdict\nimport random\n\nimport numpy as np\nimport matplotlib.pyplot as plt","visibility":"show","key":"tDC7yj5tBF"},{"type":"output","id":"pcpiSsXxD7MtgF4mKt3OW","data":[],"visibility":"show","key":"ANDIaDNO2S"}],"visibility":"show","key":"cgsrokUT6h"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"F1AN7y6DZB"},{"type":"output","id":"X5NYjG_kyaJjX9HrUboMk","data":[],"key":"mKlSGst6wf"}],"key":"dqpGiAKEzm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class TabularQ:\n    def __init__(self, default_value= lambda: 0):\n        val = default_value if callable(default_value) else lambda x: default_value\n        self.Q = defaultdict(lambda: default_value)\n\n    def __call__(self, s, a):\n        return self.Q[(s.observable_state(), a)]\n\n    def __setitem__(self, k, v):\n        s, a = k\n        self.Q[(s.observable_state(), a)] = v\n\n    def get_greedy(self, s, A_s):\n        vals = [self(s, a) for a in A_s]\n        max_val = max(vals)\n        return random.choice([a for (a, v) in zip(A_s, vals) if v == max_val])","key":"kMzyxTBpyn"},{"type":"output","id":"oK5TnGE3HngSAIuyjD5Qc","data":[],"key":"fdn6giRC8S"}],"key":"mhgc10rBWR"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Q-learning implementation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mXVR8EA1pi"}],"identifier":"q-learning-implementation","label":"Q-learning implementation","html_id":"q-learning-implementation","implicit":true,"key":"mgT3P3SNDz"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We implement Q-learning in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ubhvniac7n"},{"type":"inlineCode","value":"QLearning","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"H3sfgRzbJx"},{"type":"text","value":" class below","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AaXv1mt4LD"}],"key":"O7BaqN1yal"}],"key":"L3n2QJldWp"}],"visibility":"show","key":"emLWc0X0cx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class Qlearning(object):\n    def __init__(self, environment, default_value=0, epsilon=0.9, alpha=0.1, beta=1.0):\n        self.env = environment\n        self.Q = TabularQ(default_value=default_value)\n        self.epsilon = epsilon\n        self.alpha = alpha\n        self.beta = beta\n\n        self.restart_episode()\n\n    def restart_episode(self):\n        self.s = self.env.reset()\n\n    def get_greedy(self, s, A_s):\n        return self.Q.get_greedy(s, A_s)\n\n    def generate_A(self, s, A_s):\n        if random.random() > self.epsilon:\n            return random.choice(A_s)\n        return self.get_greedy(s, A_s)\n\n    def done(self, s=None) -> bool:\n        return self.env.done(s if s else self.s)\n\n    def step(self):\n        s = self.s\n        # first generate an A\n        A_s = self.env.enumerate_options(s)\n        a = self.generate_A(s, A_s)\n\n        # take step\n        sp, r = self.env.step(s, a)\n\n        if self.done(sp):\n            # game is over\n            self.s = sp\n            return\n\n        # get greedy a' based on Q and sp\n        A_sp = self.env.enumerate_options(sp)\n        ap = self.get_greedy(sp, A_sp)\n\n        # Do TD update\n        Q, α, β = self.Q, self.alpha, self.beta  # simplify notation\n        Q[(s, a)] = Q(s, a) + α * (r + β * Q(sp, ap) - Q(s, a))\n\n        # step forward in time\n        self.s = sp","key":"SNdDgpNAy1"},{"type":"output","id":"aFiIuF9Xx--imTrQRNjP0","data":[],"key":"PG1UUvlCBI"}],"key":"zZmOQPT85b"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Single Game test","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VaDRZ01oWC"}],"identifier":"single-game-test","label":"Single Game test","html_id":"single-game-test","implicit":true,"key":"ed9GBeMzvf"}],"visibility":"show","key":"e1NHMbeLMq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from farkle import FarkleEnv, play_game, play_many_games","key":"EhvHwkUtZw"},{"type":"output","id":"lpBUG0_eDsRmaLmjWihxr","data":[],"key":"FVTI3ONbzO"}],"key":"aBr3Z1p71z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"random.seed(40)\n\nenv = FarkleEnv(track_history=False)\nql = Qlearning(env)\nplay_game(ql)\nql.s","key":"prFgV5GRx8"},{"type":"output","id":"pE5pIsZ5mB7xhziI73_0U","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"Round: 86. Score: [10050, 9300]","content_type":"text/plain"}}}],"key":"bQvbQupjUR"}],"key":"Jbi7o0tpTw"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Longer training","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UX7m7eHSNX"}],"identifier":"longer-training","label":"Longer training","html_id":"longer-training","implicit":true,"key":"HzjvxPEQMX"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s now let our qlearning algorithm train on 5,000 games","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xvV6cfhUVg"}],"key":"LfWCZlgA02"}],"key":"OFgGsCSEDS"}],"visibility":"show","key":"F5XcvNHr2Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n\nrandom.seed(42)  # reset seed for reproducibility\nqlearning_history = play_many_games(ql, 5000)","key":"YDIMUSl3Zc"},{"type":"output","id":"3AHgI_6v9L7107pRiuYrF","data":[{"name":"stdout","output_type":"stream","text":"Done with 0/5000 (len(Q) = 539)\nDone with 500/5000 (len(Q) = 7309)\nDone with 1000/5000 (len(Q) = 8110)\nDone with 1500/5000 (len(Q) = 8658)\nDone with 2000/5000 (len(Q) = 9108)\nDone with 2500/5000 (len(Q) = 9433)\nDone with 3000/5000 (len(Q) = 9832)\nDone with 3500/5000 (len(Q) = 10164)\nDone with 4000/5000 (len(Q) = 10476)\nDone with 4500/5000 (len(Q) = 10779)\nCPU times: user 34.5 s, sys: 111 ms, total: 34.6 s\nWall time: 34.7 s\n"}],"key":"FqMXU68wmE"}],"key":"GQ5Z6jdFKA"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"code","lang":"python","executable":true,"value":"def plot_win_rate(history):\n    won = np.array([s.scores[0] > s.scores[1] for s in history])\n    game_idx = np.arange(len(won))\n\n    fig, ax = plt.subplots(figsize=(10, 6))\n    ax.plot(game_idx, won.cumsum())\n    ax.plot(game_idx, 0.5 * game_idx)\n    plt.legend([\"algo\", \"E[random agent]\"])\n    print(f\"won {sum(won)}/{len(won)} games\")","key":"YC3HVkyTf0"},{"type":"output","id":"Nvr-s0dGaIoMdVqJhxzog","data":[],"key":"P62uEuoI9v"}],"key":"BV4KntI4Kg"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_win_rate(qlearning_history)","key":"ZuKHfiiTaX"},{"type":"output","id":"dSA7I9s-7TuZlaPjF-d2N","data":[{"name":"stdout","output_type":"stream","text":"won 4103/5000 games\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"04c4c884f6066f91d98d1a14c6701900","path":"/build/04c4c884f6066f91d98d1a14c6701900.png"},"text/plain":{"content":"<Figure size 1000x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"JlTMSrLDmQ"}],"key":"kzPBvrBlFM"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Excellent! Our Q-learning algorithm seems to be doing quite a bit better than we would expect a random agent to do","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h0hK70AdOq"}],"key":"XZXbNeKAcW"}],"key":"AeC65hRQUY"}],"key":"oruIXeGKSz"}],"key":"z6LOHAWeVc"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Reinforcement Learning – TD learning","url":"/rl-02-tdlearning","group":"Reinforcement Learning"},"next":{"title":"Reinforcement Learning -- Economic Example","url":"/rl-04-career-rl","group":"Reinforcement Learning"}}},"domain":"http://localhost:3000"}