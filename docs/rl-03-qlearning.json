{"kind":"Notebook","sha256":"2ad7998f602e5206665a8d656b467ac435812dca90f028139147e7009da1e376","slug":"rl-03-qlearning","location":"/reinforcement_learning/rl.03_qlearning.ipynb","dependencies":[],"frontmatter":{"title":"Reinforcement Learning – Q-Learning","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"cap-6318","language":"python"},"authors":[{"nameParsed":{"literal":"Spencer Lyon","given":"Spencer","family":"Lyon"},"name":"Spencer Lyon","orcid":"0009-0001-6461-885X","email":"spencer.lyon@ucf.edu","affiliations":["University of Central Florida","Valorum Data"],"id":"contributors-myst-generated-uid-0","corresponding":true}],"affiliations":[{"id":"University of Central Florida","name":"University of Central Florida"},{"id":"Valorum Data","name":"Valorum Data"}],"thumbnail":"/build/sarsa_barto_sutton-ec1c9e86a95e8a4058308de2a8e1fc69.png","thumbnailOptimized":"/build/sarsa_barto_sutton-ec1c9e86a95e8a4058308de2a8e1fc69.webp","exports":[{"format":"ipynb","filename":"rl.03_qlearning.ipynb","url":"/build/rl.03_qlearning-9407d78fa305b9c65b4d54d32ec755ce.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DrkkZM1qLr"}],"key":"lHjCCPXCKQ"}],"key":"FZbCQTlhNN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Linear Algebra","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TgGuvVThV8"}],"key":"lg2MENmBge"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Statistics and Probability","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"H4VftSrWMT"}],"key":"Bseb8BSJBi"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Dynamic Programming","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"V3HTwhiOQ4"}],"key":"wWWNskInJH"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Reinforcement Learning Introduction","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"NrVFAKXaQI"}],"key":"hsSser6418"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Reinforcement Learning Sarsa algorithm","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"QGTWicNxYn"}],"key":"sgi23g2NTt"}],"key":"VA5FW3Nalf"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Outcomes","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"tdISnPROQK"}],"key":"PPpnVosTy0"}],"key":"YNOa9FEEcd"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Know the difference between on policy and off policy learning","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Q3pmwcCWVi"}],"key":"UbNjtkW8MF"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Learn the Q-learning algorithm for off policy TD based control","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"jK49tmi959"}],"key":"oWvFFKKLpN"}],"key":"epRiuAAENy"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"References","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"uv58sKXaD7"}],"key":"J62SsLfoYK"}],"key":"u3bX4sNHao"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Barto & Sutton book (online by authors ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"HgOSwUlwSd"},{"type":"link","url":"http://incompleteideas.net/book/the-book.html","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"OQ7Hb2A715"}],"urlSource":"http://incompleteideas.net/book/the-book.html","key":"UC3mlyKzMj"},{"type":"text","value":") chapters 4-6","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"L4lLIfdczN"}],"key":"sALuarukUF"}],"key":"cLAy37ck2C"}],"visibility":"show","key":"MkCdc9BVAF"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Recap","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IPdnHKDbS0"}],"identifier":"recap","label":"Recap","html_id":"recap","implicit":true,"key":"XygLEdxLo7"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In the RL problem agent observes ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"u8bqDd2HGz"},{"type":"inlineMath","value":"S","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>","key":"H9odO1LpMi"},{"type":"text","value":", makes decision ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"L4jC08bfqH"},{"type":"inlineMath","value":"A","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"tpggl90mVK"},{"type":"text","value":", sees reward and next state ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PlrH8orc4C"},{"type":"inlineMath","value":"R","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span>","key":"EVdPtKOTzQ"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VnGsVo9tjx"},{"type":"inlineMath","value":"S'","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">S&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"qCyHizpflS"},{"type":"text","value":" -- then process repeats ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pRSr5FhR9W"},{"type":"inlineMath","value":"S, A, R, S', A', ...","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>R</mi><mo separator=\"true\">,</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo separator=\"true\">,</mo><msup><mi>A</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">S, A, R, S&#x27;, A&#x27;, ...</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span></span></span></span>","key":"LicRQ0sZv2"}],"key":"IevKXF2WYf"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Sarsa uses a ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"m03kHbtuWI"},{"type":"inlineMath","value":"(S, A, R, S', A')","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>S</mi><mo separator=\"true\">,</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>R</mi><mo separator=\"true\">,</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo separator=\"true\">,</mo><msup><mi>A</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(S, A, R, S&#x27;, A&#x27;)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"mHn1Bt5Rvb"},{"type":"text","value":" quintuple to learn ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"wr0YIGCfCG"},{"type":"inlineMath","value":"Q(s, a)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Q(s, a)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span>","key":"xcMkHvOZv5"},{"type":"text","value":" that approximates ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"OPCoawzwic"},{"type":"inlineMath","value":"q^*(s, a)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>q</mi><mo>∗</mo></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">q^*(s, a)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span>","key":"rPUBrKDB0A"}],"key":"sPbPuXggV4"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Notice Sarsa uses ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RuVLj9gn3Q"},{"type":"text","value":"ε","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"B0TnFqOch9"},{"type":"text","value":"-greedy policy to propose ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CxBbQs8syS"},{"type":"inlineMath","value":"a'","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">a&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"CwvD3TUZ1D"},{"type":"text","value":" ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qJyXaH6m4l"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"AND","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"u1dSy8IqqO"}],"key":"yaa5o0OM4m"},{"type":"text","value":" uses that ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bon2dtRfjh"},{"type":"inlineMath","value":"A'","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>A</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">A&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"iiUKd4nfsu"},{"type":"text","value":" when updating ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oJK40TMHm7"},{"type":"inlineMath","value":"Q","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"gH5VbNkmcI"},{"type":"text","value":"\n","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tLcnFKLX3i"},{"type":"image","url":"/build/sarsa_barto_sutton-ec1c9e86a95e8a4058308de2a8e1fc69.png","alt":"sarsa_barto_sutton.png","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"EFXnCWz2d4","urlSource":"./sarsa_barto_sutton.png","urlOptimized":"/build/sarsa_barto_sutton-ec1c9e86a95e8a4058308de2a8e1fc69.webp"}],"key":"mwDs1dexTA"}],"key":"tJJGYYFxOD"}],"visibility":"show","key":"TIPj8Y9AcR"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"On-policy vs off-policy methods","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BLaLtAyMpI"}],"identifier":"on-policy-vs-off-policy-methods","label":"On-policy vs off-policy methods","html_id":"on-policy-vs-off-policy-methods","implicit":true,"key":"wYVXcS0e62"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Because Sarsa uses the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"L9jAJ2ri2g"},{"type":"inlineMath","value":"Q","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"oLKoD7OPsL"},{"type":"text","value":" about which it is learning to generate ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OzXvEkr211"},{"type":"inlineMath","value":"A'","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>A</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">A&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"QVeWbICPR8"},{"type":"text","value":", it is known as an ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vfvCvG5Lqo"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"on-policy","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"C8azpWYRAK"}],"key":"LK58mLDv69"},{"type":"text","value":" learning method","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jtcFCpxP74"}],"key":"sR6THvMeNS"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"On policy: make decisions based on value (policy) function being learned","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"oasocKPIMg"}],"key":"t6UnwYeBmv"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Alternative: follow any policy for proposing ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cS7LEiVXMG"},{"type":"inlineMath","value":"A'","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>A</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">A&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"xmEbCMPhQn"},{"type":"text","value":", but use the greedy policy derived from ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"OVUOdQNPvQ"},{"type":"inlineMath","value":"Q","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"NEErrxJYUj"},{"type":"text","value":" when computing ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KJzIfno0tZ"},{"type":"inlineMath","value":"TD(0)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mi>D</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">TD(0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span>","key":"wLs6Yv79lI"},{"type":"text","value":"...","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bFCcPEfCQ3"}],"key":"SF6vAbgJMl"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This is what we’ll explore today","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"N14rcV0ugP"}],"key":"LuTB4kMUPy"}],"key":"nU6mhexQA0"}],"visibility":"show","key":"AeZVJ7DBPH"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Q-learning","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SoI7plIojy"}],"identifier":"q-learning","label":"Q-learning","html_id":"q-learning","implicit":true,"key":"NToPX4Nk58"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"An early theoretical breakthrough in RL was the idea of off-policy learning","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RYUzYgV5LO"}],"key":"bmOVmawYx6"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The Q-learning algorithm was the first off-policy control algorithm to be suggested","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"mBHBIW5JaF"}],"key":"y3cHxD8yAZ"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"It allows the algorithm to make use of ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"M61RbSmHZL"},{"type":"inlineMath","value":"S, A, R, S'","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>R</mi><mo separator=\"true\">,</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">S, A, R, S&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"Ie5t6EKVFU"},{"type":"text","value":" transitions obtained from ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gsfU1MfOaa"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"any","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"c8KYLlS257"}],"key":"uRea7rNvZK"},{"type":"text","value":" source, and still learn an approximation ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jBJGVQdqUc"},{"type":"inlineMath","value":"Q","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"qLUIlV48Q4"},{"type":"text","value":" that converges to ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Bw8SSc8b4Q"},{"type":"inlineMath","value":"q^*","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>q</mi><mo>∗</mo></msup></mrow><annotation encoding=\"application/x-tex\">q^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8831em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span></span></span></span>","key":"ITTYpj6alZ"},{"type":"text","value":" with probability 1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"P7Yae2xdOe"}],"key":"ukSwH0Ubm3"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Convergence requires some conditions, most importantly that the transitions ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"qxw7lk5qmM"},{"type":"inlineMath","value":"S, A, R, S'","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>R</mi><mo separator=\"true\">,</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">S, A, R, S&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"crSwm34ogX"},{"type":"text","value":" ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"RRbMI8trMb"},{"type":"emphasis","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"cover","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"It4bxh8j94"}],"key":"o9jozAabcc"},{"type":"text","value":" the action space of ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"yEA8l6IcQ2"},{"type":"inlineMath","value":"q^*","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>q</mi><mo>∗</mo></msup></mrow><annotation encoding=\"application/x-tex\">q^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8831em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span></span></span></span>","key":"ldEEqB7tG4"}],"key":"qd3za231aZ"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Coverage","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Md08In0dWJ"}],"key":"PpB6kvJKkJ"},{"type":"text","value":" means all (s, a) pairs that are optimal under ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"y6FAVjnNdR"},{"type":"inlineMath","value":"q^*","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>q</mi><mo>∗</mo></msup></mrow><annotation encoding=\"application/x-tex\">q^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8831em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span></span></span></span>","key":"VYFB45Ts52"},{"type":"text","value":" must be visited by the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"UjVHYiFzYL"},{"type":"inlineMath","value":"S, A, R, S'","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>R</mi><mo separator=\"true\">,</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">S, A, R, S&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"JzxdbNnIpi"},{"type":"text","value":" transitions","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"MAEsciTaBo"}],"key":"Rbbl9jnxaN"}],"key":"W4EwaR1Ep4"}],"visibility":"show","key":"k2n9m53om6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example: Self-Driving Car","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dS0sdJgA1f"}],"identifier":"example-self-driving-car","label":"Example: Self-Driving Car","html_id":"example-self-driving-car","implicit":true,"key":"kwwPvzSnY6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Goal: train RL agent to safely drive vechicle","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wkMn5onhn2"}],"key":"oQ1JkHpRx7"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Sarsa method:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"WGzCrm33rw"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Give control of vehicle over to Sarsa, so it can choose ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Sdx0Wyzdp9"},{"type":"inlineMath","value":"A","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"S4YdmQ7k6o"},{"type":"text","value":" and observe implied ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GhfW8ZXUWk"},{"type":"inlineMath","value":"R","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span>","key":"eRKKlmEo4P"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gOKCPBBW2S"},{"type":"inlineMath","value":"S'","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">S&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"HZ0UZahEzA"},{"type":"text","value":" transitions","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"S5IpKJnKLH"}],"key":"tqhGU5StPM"}],"key":"Bjq25MXqCO"}],"key":"ELq2PJaapC"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Off-policy:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ZmgvQ9a8Fy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Let human expert driver drive vehicle in intended way","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"OX31eLPOCA"}],"key":"FafKd3mvbZ"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Record ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"boBgEHUAYm"},{"type":"inlineMath","value":"S, A, R, S'","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>R</mi><mo separator=\"true\">,</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">S, A, R, S&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9463em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"y6i0J3APcC"},{"type":"text","value":" transitions visited by human driver","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"fRE0nWJTah"}],"key":"axPkBVDHNJ"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Train RL agent based on data generated from human experience","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"b3QHOLMlCC"}],"key":"Ue5nArbIv5"}],"key":"qPGocnRfaw"}],"key":"lH3yh0ZLO1"}],"key":"vSNTyBZjxs"}],"key":"DIH01jfy3q"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Q-learning Algorithm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HRzplDO7EK"}],"identifier":"the-q-learning-algorithm","label":"The Q-learning Algorithm","html_id":"the-q-learning-algorithm","implicit":true,"key":"c9zJz65oED"},{"type":"image","url":"/build/q-learning_barto_sut-ad76f2782eb52a7f3c7032a9fca5c4c8.png","alt":"q-learning_barto_sutton.png","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CwjhcdXuz0","urlSource":"./q-learning_barto_sutton.png","urlOptimized":"/build/q-learning_barto_sut-ad76f2782eb52a7f3c7032a9fca5c4c8.webp"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineMath","value":"A","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"xCngx60SVv"},{"type":"text","value":" that are suggested are ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VvH8pq9hy9"},{"type":"text","value":"ε","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"aUX2muACHY"},{"type":"text","value":"-greedy in ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lbpZKOrg9D"},{"type":"inlineMath","value":"Q","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"aajYnnox5S"}],"key":"ItxF754BbS"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This is a ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"c5Rx52bpvg"},{"type":"emphasis","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"suggestion","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"gUzUWuljHF"}],"key":"qgLdsJY9Z6"},{"type":"text","value":" for how to generate ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Vwwfk6CE7l"},{"type":"inlineMath","value":"A","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"tpiUYEVUvk"},{"type":"text","value":", but anything else (including totally random) could be used","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"I4KTTV2xyq"}],"key":"KGWA8cLW8o"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"When updating the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VnVqYwx1LN"},{"type":"inlineMath","value":"t+1","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">t+1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6984em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"TSHKAbYWqx"},{"type":"text","value":" component of ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"eBrVKTfKU6"},{"type":"inlineMath","value":"TD(0)(Q)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi><mi>D</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>Q</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">TD(0)(Q)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">Q</span><span class=\"mclose\">)</span></span></span></span>","key":"GHpJGm6VdN"},{"type":"text","value":" there is an explicit ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Ac6eDbdfSG"},{"type":"inlineMath","value":"max_{a'} Q(S', a')","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>a</mi><msub><mi>x</mi><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></msub><mi>Q</mi><mo stretchy=\"false\">(</mo><msup><mi>S</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo separator=\"true\">,</mo><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">max_{a&#x27;} Q(S&#x27;, a&#x27;)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ma</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.328em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6828em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">Q</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"KeSceargSN"},{"type":"text","value":" -- it is always ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"RtgZE6tnYd"},{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"greedy","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"XacFovAt39"}],"key":"gLh79ytYkX"}],"key":"s8itPEgUgj"}],"key":"qTYxzJZODT"},{"type":"comment","value":" - By computing $TD(0)(Q)$ updates that are greedy in $Q$, Q-learning can converge to $q^*$ regardless of how $A$ are generated ","key":"LbvlHQPHnQ"}],"visibility":"show","key":"IpZWIpyCIi"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Q-learning Farkle","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sPrn0gicZQ"}],"identifier":"q-learning-farkle","label":"Q-learning Farkle","html_id":"q-learning-farkle","implicit":true,"key":"mTXoqbjHAl"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s implement the Q-learning algorithm to solve our farkle game","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"icCu9iXfZw"}],"key":"mLoBD3uZZn"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"First, some code optimizations:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"OmAvyZZj2c"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"inlineCode","value":"farkle.py","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"vHnBRV4gvV"},{"type":"text","value":" has been updated to include a method ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Zzc4muZKWQ"},{"type":"inlineCode","value":"State.observable_state","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xoVkUqyu0x"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This method returns a tuple containing only how many dice are rollable, sum collected in turn, and what rolled dice are showing","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"dtrJDhbBMN"}],"key":"rmxmDmCMiT"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Drops scores, round, etc.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nvEeN0D5O1"}],"key":"M0Da8DDSCh"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Implication -- we will have agent learn to maximize score each turn","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"jeCuYJersj"}],"key":"Z66TigDk7P"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"If agent scores high every turn, should be able to win game","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"h2HqMlrJVi"}],"key":"vYmI1LNttj"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Loses ability to customize behavior based on “stage” of game (aggressive play to catch up, or conservative to maintain lead)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"TYxPdUS23S"}],"key":"XcReWxrEfj"}],"key":"GyZ0k4O3mh"}],"key":"robeWrFuK7"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Creatd a ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"qTNlStES7s"},{"type":"inlineCode","value":"TablularQ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"RHKnfT5HOT"},{"type":"text","value":" class below that uses this ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"pdMLVOc2pr"},{"type":"inlineCode","value":"State.observable_state","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ZOoNdwlaFg"},{"type":"text","value":" method","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"FTH5HPp782"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Allows RL algorithms to not worry about ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"FaAwSYf5Bd"},{"type":"inlineCode","value":"State.observable_state","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"jViwahbaFB"}],"key":"Y5bbRzWnq0"}],"key":"D8sR4p86Jt"}],"key":"TYlXTK7TJF"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Remove history tracking from ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"xAPqaorTzZ"},{"type":"inlineCode","value":"FarkleEnv","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"HM7J7BSR7T"},{"type":"text","value":" (see ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"s00JaqXqhS"},{"type":"inlineCode","value":"FarkleEnv","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"S7J4DkKjj4"},{"type":"text","value":" in farkle.py file)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"GIC5xjqowh"}],"key":"EXQpRamfCc"}],"key":"VcIG5TAjzX"}],"key":"XGaUwxxLs5"}],"key":"H3CfQnajbl"}],"visibility":"show","key":"OQFLFHlCMw"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from collections import defaultdict\nimport random\n\nimport numpy as np\nimport matplotlib.pyplot as plt","visibility":"show","key":"sSbMeqcYvf"},{"type":"output","id":"K9nCs0yebo2C12VG99p0K","data":[],"visibility":"show","key":"qODRvpGMXl"}],"visibility":"show","key":"UXSHLRzJkk"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"","key":"zsivmxqn5Q"},{"type":"output","id":"lS3sfTaG8TssVJ3dNVXS_","data":[],"key":"C6x23dnbQX"}],"key":"uH8wPDVH77"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"class TabularQ:\n    def __init__(self, default_value= lambda: 0):\n        val = default_value if callable(default_value) else lambda x: default_value\n        self.Q = defaultdict(lambda: default_value)\n\n    def __call__(self, s, a):\n        return self.Q[(s.observable_state(), a)]\n\n    def __setitem__(self, k, v):\n        s, a = k\n        self.Q[(s.observable_state(), a)] = v\n\n    def get_greedy(self, s, A_s):\n        vals = [self(s, a) for a in A_s]\n        max_val = max(vals)\n        return random.choice([a for (a, v) in zip(A_s, vals) if v == max_val])","key":"dBel6J4VPb"},{"type":"output","id":"fJZTyOPdCBGNHp7yWXgfK","data":[],"key":"aUXGzaMeP2"}],"key":"hQ2iMCHsEq"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Q-learning implementation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fQbBMYQQlH"}],"identifier":"q-learning-implementation","label":"Q-learning implementation","html_id":"q-learning-implementation","implicit":true,"key":"HpfqDzfVnu"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We implement Q-learning in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qSCxZQG17Y"},{"type":"inlineCode","value":"QLearning","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"luzl2aHkxq"},{"type":"text","value":" class below","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"F9CVJLAGGR"}],"key":"t6bWNQ9lOM"}],"key":"l5nlC5Ym4o"}],"visibility":"show","key":"gy8XtyutnG"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"class Qlearning(object):\n    def __init__(self, environment, default_value=0, epsilon=0.9, alpha=0.1, beta=1.0):\n        self.env = environment\n        self.Q = TabularQ(default_value=default_value)\n        self.epsilon = epsilon\n        self.alpha = alpha\n        self.beta = beta\n\n        self.restart_episode()\n\n    def restart_episode(self):\n        self.s = self.env.reset()\n\n    def get_greedy(self, s, A_s):\n        return self.Q.get_greedy(s, A_s)\n\n    def generate_A(self, s, A_s):\n        if random.random() > self.epsilon:\n            return random.choice(A_s)\n        return self.get_greedy(s, A_s)\n\n    def done(self, s=None) -> bool:\n        return self.env.done(s if s else self.s)\n\n    def step(self):\n        s = self.s\n        # first generate an A\n        A_s = self.env.enumerate_options(s)\n        a = self.generate_A(s, A_s)\n\n        # take step\n        sp, r = self.env.step(s, a)\n\n        if self.done(sp):\n            # game is over\n            self.s = sp\n            return\n\n        # get greedy a' based on Q and sp\n        A_sp = self.env.enumerate_options(sp)\n        ap = self.get_greedy(sp, A_sp)\n\n        # Do TD update\n        Q, α, β = self.Q, self.alpha, self.beta  # simplify notation\n        Q[(s, a)] = Q(s, a) + α * (r + β * Q(sp, ap) - Q(s, a))\n\n        # step forward in time\n        self.s = sp","key":"bj2zw4FMT1"},{"type":"output","id":"Tp_wfIrcmBn5Ebz_94V7K","data":[],"key":"ypMFd8LDxB"}],"key":"TMkHV7svc5"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Single Game test","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tOgleBRvbT"}],"identifier":"single-game-test","label":"Single Game test","html_id":"single-game-test","implicit":true,"key":"nCLdnMW4Gg"}],"visibility":"show","key":"ZKN5bFwSMG"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"from farkle import FarkleEnv, play_game, play_many_games","key":"k5Lr3z942D"},{"type":"output","id":"_jyEaqYRZREQsL2nNVbtX","data":[],"key":"DyAccvo4Ye"}],"key":"hN9sXi2fmu"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"random.seed(40)\n\nenv = FarkleEnv(track_history=False)\nql = Qlearning(env)\nplay_game(ql)\nql.s","key":"B9auvf2ILm"},{"type":"output","id":"4sa-aTqjyiH62TxyE_hMr","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"Round: 86. Score: [10050, 9300]","content_type":"text/plain"}}}],"key":"TvJBkQUrJ3"}],"key":"VwHz4DSEQP"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Longer training","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ca2WCvhOsq"}],"identifier":"longer-training","label":"Longer training","html_id":"longer-training","implicit":true,"key":"pdO4RlaJ8f"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s now let our qlearning algorithm train on 5,000 games","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"h0T5W2aICT"}],"key":"zA0BGiwpph"}],"key":"XUa3t8dafO"}],"visibility":"show","key":"u6c4rphEpy"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n\nrandom.seed(42)  # reset seed for reproducibility\nqlearning_history = play_many_games(ql, 5000)","key":"MzJb9fiEu2"},{"type":"output","id":"JpFNfH_KmmVBGMGMzg87B","data":[{"name":"stdout","output_type":"stream","text":"Done with 0/5000 (len(Q) = 539)\nDone with 500/5000 (len(Q) = 7309)\nDone with 1000/5000 (len(Q) = 8110)\nDone with 1500/5000 (len(Q) = 8658)\nDone with 2000/5000 (len(Q) = 9108)\nDone with 2500/5000 (len(Q) = 9433)\nDone with 3000/5000 (len(Q) = 9832)\nDone with 3500/5000 (len(Q) = 10164)\nDone with 4000/5000 (len(Q) = 10476)\nDone with 4500/5000 (len(Q) = 10779)\nCPU times: user 34.5 s, sys: 111 ms, total: 34.6 s\nWall time: 34.7 s\n"}],"key":"jVRXfjgErh"}],"key":"LN9qpsyPrb"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"code","lang":"python","executable":true,"value":"def plot_win_rate(history):\n    won = np.array([s.scores[0] > s.scores[1] for s in history])\n    game_idx = np.arange(len(won))\n\n    fig, ax = plt.subplots(figsize=(10, 6))\n    ax.plot(game_idx, won.cumsum())\n    ax.plot(game_idx, 0.5 * game_idx)\n    plt.legend([\"algo\", \"E[random agent]\"])\n    print(f\"won {sum(won)}/{len(won)} games\")","key":"KAObU1ljwl"},{"type":"output","id":"pG27rFNFLavz2_y5tq9ze","data":[],"key":"xenfPusS2b"}],"key":"YVM5xbhyzJ"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_win_rate(qlearning_history)","key":"cZadeHG7Gx"},{"type":"output","id":"6qfFqzGo7t1sX0W1K8TxV","data":[{"name":"stdout","output_type":"stream","text":"won 4103/5000 games\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"04c4c884f6066f91d98d1a14c6701900","path":"/build/04c4c884f6066f91d98d1a14c6701900.png"},"text/plain":{"content":"<Figure size 1000x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"u8tduhWCo7"}],"key":"j2VNmI6Mpc"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Excellent! Our Q-learning algorithm seems to be doing quite a bit better than we would expect a random agent to do","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oHcYxS3STj"}],"key":"mqNGEg3JC5"}],"key":"zyFNOfR7lM"}],"key":"FZPFGEFuG8"}],"key":"eUi8fpQnRe"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Reinforcement Learning – TD learning","url":"/rl-02-tdlearning","group":"Reinforcement Learning"},"next":{"title":"Reinforcement Learning -- Economic Example","url":"/rl-04-career-rl","group":"Reinforcement Learning"}}},"domain":"http://localhost:3001"}